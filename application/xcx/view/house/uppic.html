{include file="index/header" /}
<link rel="stylesheet" type="text/css" href="__PUBLIC__/static/css/style.css" />
<script id="script" src="__PUBLIC__/static/js/Jsequencing.js" iconfont="true"></script>
<style>
    .picbox{
        width: 100%;
        height: 150px;
        overflow: hidden;
        float: left;
        display: inline-block;
    }
    .item{
        width: 25%;
        height: 150px;
        float: left;
    }
</style>
<div class="layui-body">
    <div style="margin: 20px;">
    <span class="layui-breadcrumb" lay-separator=">">
       <a>房源管理</a>
        <a href="<?=url('house/index')?>">房源列表</a>
        <a><cite>发布房源</cite></a>
    </span>
        <div style="float:right;">
            <a href="javascript:history.go(-1);" class="layui-btn layui-btn-primary layui-btn-sm">
                <i class="layui-icon layui-icon-return"></i>
                返回列表</a>
        </div>
    </div>
    <hr/>
    <div style="margin: 10px">
        <div style="padding: 15px;">
            <form class="layui-form" id="myForm" action="<?=url('house/add')?>" method="post">
                <fieldset class="layui-elem-field layui-field-title" style="margin-top: 20px;">
                    <legend>图片</legend>
                </fieldset>
                <div style="width: 100%;">
                    <div class="right">
                        <div class="layui-form-mid layui-word-aux" style="margin-left: 40px;">请上传0-8张其他详情图。</div>
                        <div class="layui-form-item">
                            <div class="layui-input-inline" style="width: 100%;margin-left: 50px;">
                                <div class="pic-more" style="height: 266px">
                                    <ul class="pic-more-upload-list" id="slide-pc-priview" style="width: 100%">
                                    </ul>
                                </div>
                                <div class="layui-upload">
                                    <button type="button" class="layui-btn layui-btn pull-left layui-btn-sm" id="slide-pc">请选择其他图片</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </div>
    {include file="index/footer" /}
    <script>
        layui.use('upload', function(){
            var $ = layui.jquery;
            var upload = layui.upload;
            upload.render({
                elem: '#slide-pc',
                url: '{:url("house/upload2")}',
                size: 1024*1024*10,
                exts: 'jpg|png|jpeg|gif|bmp|JPG',
                multiple: true,
                before: function(obj) {
                    layer.msg('图片上传中...', {
                        icon: 16,
                        shade: 0.01,
                        time: 0
                    })
                },
                done: function(res) {
                    layer.close(layer.msg());//关闭上传提示窗口
                    if(res.status == 0) {
                        return layer.msg(res.message);
                    }
                    if(res.code ==1){
                        var src = res.filepath;
                        console.log(src);
                        addimg(src);
                    }else{
                        return layer.msg(res.msg);
                    }

                }
            });
        });
        //点击多图上传的X,删除当前的图片
        $("body").on("click",".close",function(){
            $(this).closest("li").remove();
        });
        var imgulp = new Jsequencing({
            listid:"slide-pc-priview",//页面图片列表ID
            thumbherf:"http://www.huaxiang.com/",//列表图片前缀
            bigherf:"http://www.huaxiang.com/",//原图前缀[同列表图相同时，省略]
            jsondata:true,
            imgsrcarr:[
            ],
        });
        function addimg(src){
            console.log(123);
            imgulp.addimgarr([
                {src:src}
            ])
        }
    </script>